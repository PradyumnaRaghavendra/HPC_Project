# RAGEN Configuration - Medium WebShop (Debugging)

model:
  name: "Qwen/Qwen2.5-3B-Instruct"
  ref_model: "Qwen/Qwen2.5-3B-Instruct"
  max_length: 2048
  sft_max_length: 512
  device: "cuda"

apo:
  beta: 0.5
  v_star_samples: 2
  adaptive_vstar: true
  learning_rate: 0.000003  # Reduced from 1e-5 to 3e-6 for stability
  batch_size: 4
  gradient_accumulation_steps: 8
  kl_coef: 0.1  # Increased from 0.02 to 0.1 to prevent divergence
  adv_clip: 1.0  # Reduced from 2.0 to 1.0 for more conservative updates
  clip_grad_norm: 0.5  # Reduced from 1.0 to 0.5 for extra stability
  weighting_scheme: "exp"
  adaptive_clip: false

sampling:
  temperature: 0.8
  top_p: 0.9
  top_k: 0
  use_min_new_tokens: false
  min_new_tokens: 10

training:
  num_epochs: 4
  max_steps: 100
  eval_every: 20
  save_every: 20

environment:
  type: "medium"  # ‚Üê Use medium WebShop
  max_turns: 5

# Curriculum disabled
curriculum:
  enabled: false

data:
  train_size: 100
  eval_size: 25

logging:
  use_wandb: false
  log_every: 5

seed: 42

# Uncertainty filtering
uncertainty_filtering:
  enabled: true
  keep_percent: 0.50
  start_step: 30
